# File: model.py
import requests
import json

def get_model_response(prompt):
    url = 'http://localhost:11434/api/generate'
    headers = {'Content-Type': 'application/json'}
    data = {
        "model": "dolphin-llama3:8b-256k",
        "prompt": prompt,
        "options": {"num_ctx": 256000}
    }

    print(f"Sending request to model with prompt: {prompt}")  
    try:
        response = requests.post(url, json=data, headers=headers, stream=True)
        response.raise_for_status()

        model_response = ""
        for line in response.iter_lines():
            if line:
                decoded_line = line.decode('utf-8')
                json_response = json.loads(decoded_line)
                model_response += json_response.get('response', '')
                print("Part of response received:", json_response.get('response'))  
                if json_response.get('done', False):
                    print("Final response assembled:", model_response)  
                    break
        return model_response

    except requests.exceptions.RequestException as e:
        error_message = f"An error occurred: {str(e)}"
        print(error_message)  
        return error_message



